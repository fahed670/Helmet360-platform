<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helmet360 - Construction Platform UAE</title>
    
    <!-- Arabic Font -->
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8fafc;
            transition: all 0.3s ease;
        }

        [dir="rtl"] {
            font-family: 'Cairo', sans-serif;
        }

        [dir="rtl"] * {
            text-align: right;
        }

        [dir="rtl"] .hero,
        [dir="rtl"] .stats,
        [dir="rtl"] .features .container,
        [dir="rtl"] .pricing .container {
            text-align: center;
        }

        .header {
            background: white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            padding: 15px 20px;
        }

        .nav {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        [dir="rtl"] .nav {
            flex-direction: row-reverse;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #2563eb;
        }

        .nav-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        [dir="rtl"] .nav-buttons {
            flex-direction: row-reverse;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #2563eb;
            color: white;
        }

        .btn-primary:hover {
            background: #1d4ed8;
        }

        .btn-outline {
            background: transparent;
            color: #2563eb;
            border: 1px solid #2563eb;
        }

        .btn-outline:hover {
            background: #2563eb;
            color: white;
        }

        .lang-btn {
            background: #f3f4f6;
            color: #374151;
            border: 1px solid #d1d5db;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
        }

        .hero {
            background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white;
            padding: 120px 20px 80px;
            text-align: center;
        }

        .hero h1 {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            opacity: 0.9;
        }

        .hero-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-hero {
            padding: 15px 30px;
            font-size: 1.1rem;
        }

        .stats {
            background: white;
            padding: 60px 20px;
            margin-top: -30px;
            position: relative;
            border-radius: 15px 15px 0 0;
        }

        .stats-grid {
            max-width: 1200px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            text-align: center;
        }

        .stat-item {
            padding: 20px;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2563eb;
            display: block;
        }

        .stat-label {
            color: #6b7280;
            font-weight: 500;
        }

        .features {
            padding: 80px 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .section-subtitle {
            text-align: center;
            color: #6b7280;
            font-size: 1.2rem;
            margin-bottom: 60px;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
        }

        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .feature-icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .feature-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .feature-text {
            color: #6b7280;
            line-height: 1.6;
        }

        .pricing {
            background: #f8fafc;
            padding: 80px 20px;
        }

        .pricing-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 50px;
        }

        .pricing-card {
            background: white;
            border-radius: 10px;
            padding: 40px 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            position: relative;
        }

        .pricing-card.featured {
            border: 2px solid #2563eb;
            transform: scale(1.05);
        }

        .pricing-badge {
            background: #2563eb;
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
        }

        .pricing-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .pricing-price {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2563eb;
            margin-bottom: 5px;
        }

        .pricing-period {
            color: #6b7280;
            margin-bottom: 30px;
        }

        .pricing-features {
            list-style: none;
            margin-bottom: 30px;
            text-align: left;
        }

        [dir="rtl"] .pricing-features {
            text-align: right;
        }

        .pricing-features li {
            padding: 8px 0;
            border-bottom: 1px solid #f3f4f6;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 2000;
        }

        .modal-content {
            background: white;
            margin: 50px auto;
            padding: 30px;
            border-radius: 10px;
            max-width: 500px;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 24px;
            cursor: pointer;
            color: #6b7280;
        }

        [dir="rtl"] .modal-close {
            right: auto;
            left: 20px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 16px;
        }

        [dir="rtl"] .form-input {
            text-align: right;
        }

        .form-input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .alert {
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .alert-success {
            background: #d1fae5;
            color: #065f46;
        }

        .alert-error {
            background: #fee2e2;
            color: #991b1b;
        }

        .badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-verified {
            background: #dbeafe;
            color: #1e40af;
        }

        .badge-unverified {
            background: #f3f4f6;
            color: #6b7280;
        }

        .footer {
            background: #1f2937;
            color: white;
            padding: 40px 20px;
            text-align: center;
        }

        .footer p {
            color: #9ca3af;
        }

        @media (max-width: 768px) {
            .nav {
                flex-direction: column;
                gap: 15px;
            }

            [dir="rtl"] .nav {
                flex-direction: column;
            }

            .hero h1 {
                font-size: 2rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .features-grid {
                grid-template-columns: 1fr;
            }

            .pricing-grid {
                grid-template-columns: 1fr;
            }

            .pricing-card.featured {
                transform: none;
            }
        }

        .hidden {
            display: none !important;
        }

        .spinner {
            border: 2px solid #f3f3f3;
            border-top: 2px solid #2563eb;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        [dir="rtl"] .spinner {
            margin-right: 0;
            margin-left: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="logo">Helmet360</div>
            <div class="nav-buttons">
                <button class="lang-btn" onclick="toggleLanguage()" id="langToggle">ÿπÿ±ÿ®Ÿä</button>
                <button class="btn btn-outline" onclick="showLogin()" id="loginBtn">Login</button>
                <button class="btn btn-primary" onclick="showRegister()" id="registerBtn">Register</button>
                
                <div class="user-menu hidden" id="userMenu">
                    <button class="btn btn-outline" onclick="showDashboard()" id="dashboardBtn">Dashboard</button>
                    <button class="btn btn-outline" onclick="logout()" id="logoutBtn">Logout</button>
                </div>
            </div>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="container">
            <h1 id="heroTitle">Connect. Build. Grow.</h1>
            <p id="heroText">The premier platform connecting construction companies, contractors, and suppliers across the UAE. No intermediaries, just direct business connections.</p>
            
            <div class="hero-buttons">
                <button class="btn btn-primary btn-hero" onclick="showRegister()" id="heroBtn1">Start Building Your Network</button>
                <button class="btn btn-outline btn-hero" style="background: rgba(255,255,255,0.1); border-color: white;" id="heroBtn2">Watch Demo</button>
            </div>
        </div>
    </section>

    <!-- Statistics Section -->
    <section class="stats">
        <div class="stats-grid">
            <div class="stat-item">
                <span class="stat-number" id="totalCompanies">150+</span>
                <div class="stat-label" id="statLabel1">Registered Companies</div>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="verifiedCompanies">89</span>
                <div class="stat-label" id="statLabel2">Verified Companies</div>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="activeProjects">234</span>
                <div class="stat-label" id="statLabel3">Active Projects</div>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="contractValue">45M+</span>
                <div class="stat-label" id="statLabel4">Total Contract Value (AED)</div>
            </div>
            <div class="stat-item">
                <span class="stat-number" id="completedProjects">456</span>
                <div class="stat-label" id="statLabel5">Completed Projects</div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features">
        <div class="container">
            <h2 class="section-title" id="featuresTitle">Why Choose Helmet360?</h2>
            <p class="section-subtitle" id="featuresSubtitle">Built specifically for the UAE construction market with features that matter to your business.</p>

            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">üèóÔ∏è</div>
                    <h3 class="feature-title" id="feature1Title">Direct Connections</h3>
                    <p class="feature-text" id="feature1Text">Connect directly with verified construction companies, contractors, and suppliers without intermediaries.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">‚úÖ</div>
                    <h3 class="feature-title" id="feature2Title">Verified Companies</h3>
                    <p class="feature-text" id="feature2Text">All companies go through our verification process to ensure credibility and trustworthiness.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üìã</div>
                    <h3 class="feature-title" id="feature3Title">Project Management</h3>
                    <p class="feature-text" id="feature3Text">Comprehensive tools to manage your projects from initial posting to completion.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üí∞</div>
                    <h3 class="feature-title" id="feature4Title">Transparent Pricing</h3>
                    <p class="feature-text" id="feature4Text">Clear pricing structure with free access for verified companies and affordable plans for others.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üåê</div>
                    <h3 class="feature-title" id="feature5Title">Bilingual Platform</h3>
                    <p class="feature-text" id="feature5Text">Full support for Arabic and English to serve all businesses in the UAE market.</p>
                </div>

                <div class="feature-card">
                    <div class="feature-icon">üì±</div>
                    <h3 class="feature-title" id="feature6Title">Mobile Optimized</h3>
                    <p class="feature-text" id="feature6Text">Access your projects and manage your business from anywhere with our mobile-optimized platform.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Pricing Section -->
    <section class="pricing">
        <div class="container">
            <h2 class="section-title" id="pricingTitle">Choose Your Plan</h2>
            <p class="section-subtitle" id="pricingSubtitle">Flexible pricing options designed for businesses of all sizes in the UAE construction market.</p>

            <div class="pricing-grid">
                <div class="pricing-card">
                    <h3 class="pricing-title" id="plan1Title">Verified Companies</h3>
                    <div class="pricing-price" id="plan1Price">FREE</div>
                    <div class="pricing-period" id="plan1Period">Always Free</div>
                    
                    <ul class="pricing-features">
                        <li id="plan1Feature1">‚úì Post unlimited projects</li>
                        <li id="plan1Feature2">‚úì Access all contracts</li>
                        <li id="plan1Feature3">‚úì Company profile & verification badge</li>
                        <li id="plan1Feature4">‚úì Basic project management tools</li>
                        <li id="plan1Feature5">‚úì Direct messaging</li>
                    </ul>
                    
                    <button class="btn btn-outline" onclick="showRegister()" id="plan1Btn">Get Verified</button>
                </div>

                <div class="pricing-card featured">
                    <div class="pricing-badge" id="popularBadge">Most Popular</div>
                    <h3 class="pricing-title" id="plan2Title">Premium Plan</h3>
                    <div class="pricing-price">299</div>
                    <div class="pricing-period" id="plan2Period">AED / month</div>
                    
                    <ul class="pricing-features">
                        <li id="plan2Feature1">‚úì Everything in Free Plan</li>
                        <li id="plan2Feature2">‚úì Featured project listings</li>
                        <li id="plan2Feature3">‚úì Advanced analytics & reporting</li>
                        <li id="plan2Feature4">‚úì Priority customer support</li>
                        <li id="plan2Feature5">‚úì Enhanced company profile</li>
                        <li id="plan2Feature6">‚úì Unlimited file uploads</li>
                    </ul>
                    
                    <button class="btn btn-primary" onclick="showRegister()" id="plan2Btn">Start Premium</button>
                </div>

                <div class="pricing-card">
                    <h3 class="pricing-title" id="plan3Title">Basic Plan</h3>
                    <div class="pricing-price">149</div>
                    <div class="pricing-period" id="plan3Period">AED / month</div>
                    
                    <ul class="pricing-features">
                        <li id="plan3Feature1">‚úì Post up to 10 projects/month</li>
                        <li id="plan3Feature2">‚úì Access to all contracts</li>
                        <li id="plan3Feature3">‚úì Basic company profile</li>
                        <li id="plan3Feature4">‚úì Standard project tools</li>
                        <li id="plan3Feature5">‚úì Email support</li>
                    </ul>
                    
                    <button class="btn btn-outline" onclick="showRegister()" id="plan3Btn">Start Basic</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <h3>Helmet360</h3>
            <p id="footerText">¬© 2025 Helmet360. All rights reserved. Made for the UAE construction industry.</p>
        </div>
    </footer>

    <!-- Login Modal -->
    <div class="modal" id="loginModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('loginModal')">&times;</span>
            <h2 id="loginTitle">Login to Your Account</h2>
            <div id="loginAlert"></div>
            <form id="loginForm">
                <div class="form-group">
                    <label class="form-label" id="loginEmailLabel">Email</label>
                    <input type="email" class="form-input" id="loginEmail" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="loginPasswordLabel">Password</label>
                    <input type="password" class="form-input" id="loginPassword" required>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="spinner hidden" id="loginSpinner"></span>
                    <span id="loginText">Login</span>
                </button>
            </form>
            <p style="text-align: center; margin-top: 20px;" id="loginSignupText">
                Don't have an account? <a href="#" onclick="showRegister(); closeModal('loginModal')" style="color: #2563eb;" id="loginSignupLink">Register here</a>
            </p>
        </div>
    </div>

    <!-- Register Modal -->
    <div class="modal" id="registerModal">
        <div class="modal-content">
            <span class="modal-close" onclick="closeModal('registerModal')">&times;</span>
            <h2 id="registerTitle">Create Your Account</h2>
            <div id="registerAlert"></div>
            <form id="registerForm">
                <div class="form-group">
                    <label class="form-label" id="companyNameLabel">Company Name</label>
                    <input type="text" class="form-input" id="companyName" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="businessTypeLabel">Business Type</label>
                    <select class="form-input" id="businessType" required>
                        <option value="" id="businessTypeOption0">Select business type</option>
                        <option value="construction" id="businessTypeOption1">Construction Company</option>
                        <option value="contracting" id="businessTypeOption2">Contracting Company</option>
                        <option value="materials" id="businessTypeOption3">Materials Supplier</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label" id="contactPersonLabel">Contact Person</label>
                    <input type="text" class="form-input" id="contactPerson" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="phoneLabel">Phone</label>
                    <input type="tel" class="form-input" id="phone" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="emailLabel">Email</label>
                    <input type="email" class="form-input" id="email" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="passwordLabel">Password</label>
                    <input type="password" class="form-input" id="password" required>
                </div>
                <div class="form-group">
                    <label class="form-label" id="cityLabel">City</label>
                    <select class="form-input" id="city">
                        <option value="Abu Dhabi">Abu Dhabi</option>
                        <option value="Dubai">Dubai</option>
                        <option value="Sharjah">Sharjah</option>
                        <option value="Ajman">Ajman</option>
                        <option value="Ras Al Khaimah">Ras Al Khaimah</option>
                        <option value="Fujairah">Fujairah</option>
                        <option value="Umm Al Quwain">Umm Al Quwain</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary" style="width: 100%;">
                    <span class="spinner hidden" id="registerSpinner"></span>
                    <span id="registerText">Create Account</span>
                </button>
            </form>
            <p style="text-align: center; margin-top: 20px;" id="registerLoginText">
                Already have an account? <a href="#" onclick="showLogin(); closeModal('registerModal')" style="color: #2563eb;" id="registerLoginLink">Login here</a>
            </p>
        </div>
    </div>

    <!-- Dashboard Modal -->
    <div class="modal" id="dashboardModal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="modal-close" onclick="closeModal('dashboardModal')">&times;</span>
            <h2 id="dashboardTitle">Company Dashboard</h2>
            <div id="dashboardContent">
                <div style="text-align: center; padding: 40px;">
                    <div class="spinner"></div>
                    <span id="dashboardLoading">Loading dashboard...</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://eaqptoghojfgrtqeoxog.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImVhcXB0b2dob2pmZ3J0cWVveG9nIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5NzE5MTksImV4cCI6MjA3MjU0NzkxOX0.A9PxMUkNJjwJmfT-HNCZjYytJW_l4_vk3hwZJQ2LMd8';
        
        // Initialize Supabase with fallback
        let supabase = null;
        let isOfflineMode = false;
        
        try {
            if (window.supabase && typeof window.supabase.createClient === 'function') {
                supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
            } else {
                throw new Error('Supabase library not loaded');
            }
        } catch (error) {
            console.warn('Supabase not available, running in offline mode:', error);
            isOfflineMode = true;
        }

        // Global variables
        let currentUser = null;
        let isArabic = false;

        // Complete translation object
        const translations = {
            // Navigation
            loginBtn: { en: 'Login', ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ' },
            registerBtn: { en: 'Register', ar: 'ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ' },
            dashboardBtn: { en: 'Dashboard', ar: 'ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ' },
            logoutBtn: { en: 'Logout', ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿÆÿ±Ÿàÿ¨' },
            
            // Hero Section
            heroTitle: { en: 'Connect. Build. Grow.', ar: 'ÿßÿ™ÿµŸÑ. ÿßÿ®ŸÜŸä. ÿßŸÜŸÖŸà.' },
            heroText: { en: 'The premier platform connecting construction companies, contractors, and suppliers across the UAE. No intermediaries, just direct business connections.', ar: 'ÿßŸÑŸÖŸÜÿµÿ© ÿßŸÑÿ±ÿßÿ¶ÿØÿ© ŸÑÿ±ÿ®ÿ∑ ÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑÿ®ŸÜÿßÿ° ŸàÿßŸÑŸÖŸÇÿßŸàŸÑŸäŸÜ ŸàÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ŸÅŸä ÿØŸàŸÑÿ© ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™ ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ÿßŸÑŸÖÿ™ÿ≠ÿØÿ©. ÿ®ÿØŸàŸÜ Ÿàÿ≥ÿ∑ÿßÿ°ÿå ŸÅŸÇÿ∑ ÿßÿ™ÿµÿßŸÑÿßÿ™ ÿ™ÿ¨ÿßÿ±Ÿäÿ© ŸÖÿ®ÿßÿ¥ÿ±ÿ©.' },
            heroBtn1: { en: 'Start Building Your Network', ar: 'ÿßÿ®ÿØÿ£ ÿ®ÿ®ŸÜÿßÿ° ÿ¥ÿ®ŸÉÿ™ŸÉ' },
            heroBtn2: { en: 'Watch Demo', ar: 'ÿ¥ÿßŸáÿØ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™Ÿàÿ∂Ÿäÿ≠Ÿä' },
            
            // Statistics
            statLabel1: { en: 'Registered Companies', ar: 'ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÖÿ≥ÿ¨ŸÑÿ©' },
            statLabel2: { en: 'Verified Companies', ar: 'ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÖŸàÿ´ŸÇÿ©' },
            statLabel3: { en: 'Active Projects', ar: 'ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ ÿßŸÑŸÜÿ¥ÿ∑ÿ©' },
            statLabel4: { en: 'Total Contract Value (AED)', ar: 'ÿ•ÿ¨ŸÖÿßŸÑŸä ŸÇŸäŸÖÿ© ÿßŸÑÿπŸÇŸàÿØ (ÿØÿ±ŸáŸÖ)' },
            statLabel5: { en: 'Completed Projects', ar: 'ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ ÿßŸÑŸÖŸÉÿ™ŸÖŸÑÿ©' },
            
            // Features Section
            featuresTitle: { en: 'Why Choose Helmet360?', ar: 'ŸÑŸÖÿßÿ∞ÿß ÿ™ÿÆÿ™ÿßÿ± ÿÆŸàÿ∞ÿ©360ÿü' },
            featuresSubtitle: { en: 'Built specifically for the UAE construction market with features that matter to your business.', ar: 'ŸÖÿµŸÖŸÖ ÿÆÿµŸäÿµÿßŸã ŸÑÿ≥ŸàŸÇ ÿßŸÑÿ®ŸÜÿßÿ° ŸÅŸä ÿØŸàŸÑÿ© ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™ ŸÖÿπ ŸÖŸÖŸäÿ≤ÿßÿ™ ÿ™ŸáŸÖ ÿπŸÖŸÑŸÉ.' },
            
            feature1Title: { en: 'Direct Connections', ar: 'ÿßÿ™ÿµÿßŸÑÿßÿ™ ŸÖÿ®ÿßÿ¥ÿ±ÿ©' },
            feature1Text: { en: 'Connect directly with verified construction companies, contractors, and suppliers without intermediaries.', ar: 'ÿßÿ™ÿµŸÑ ŸÖÿ®ÿßÿ¥ÿ±ÿ© ŸÖÿπ ÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑÿ®ŸÜÿßÿ° ŸàÿßŸÑŸÖŸÇÿßŸàŸÑŸäŸÜ ŸàÿßŸÑŸÖŸàÿ±ÿØŸäŸÜ ÿßŸÑŸÖŸàÿ´ŸÇŸäŸÜ ÿ®ÿØŸàŸÜ Ÿàÿ≥ÿ∑ÿßÿ°.' },
            
            feature2Title: { en: 'Verified Companies', ar: 'ÿ¥ÿ±ŸÉÿßÿ™ ŸÖŸàÿ´ŸÇÿ©' },
            feature2Text: { en: 'All companies go through our verification process to ensure credibility and trustworthiness.', ar: 'ÿ¨ŸÖŸäÿπ ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿ™ŸÖÿ± ÿ®ÿπŸÖŸÑŸäÿ© ÿßŸÑÿ™ÿ≠ŸÇŸÇ ŸÑÿØŸäŸÜÿß ŸÑÿ∂ŸÖÿßŸÜ ÿßŸÑŸÖÿµÿØÿßŸÇŸäÿ© ŸàÿßŸÑÿ´ŸÇÿ©.' },
            
            feature3Title: { en: 'Project Management', ar: 'ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ' },
            feature3Text: { en: 'Comprehensive tools to manage your projects from initial posting to completion.', ar: 'ÿ£ÿØŸàÿßÿ™ ÿ¥ÿßŸÖŸÑÿ© ŸÑÿ•ÿØÿßÿ±ÿ© ŸÖÿ¥ÿßÿ±ŸäÿπŸÉ ŸÖŸÜ ÿßŸÑŸÜÿ¥ÿ± ÿßŸÑÿ£ŸàŸÑŸä ÿ•ŸÑŸâ ÿßŸÑÿ•ŸÉŸÖÿßŸÑ.' },
            
            feature4Title: { en: 'Transparent Pricing', ar: 'ÿ™ÿ≥ÿπŸäÿ± ÿ¥ŸÅÿßŸÅ' },
            feature4Text: { en: 'Clear pricing structure with free access for verified companies and affordable plans for others.', ar: 'ŸáŸäŸÉŸÑ ÿ™ÿ≥ÿπŸäÿ± Ÿàÿßÿ∂ÿ≠ ŸÖÿπ ŸàÿµŸàŸÑ ŸÖÿ¨ÿßŸÜŸä ŸÑŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÖŸàÿ´ŸÇÿ© ŸàÿÆÿ∑ÿ∑ ŸÖŸäÿ≥Ÿàÿ±ÿ© ÿßŸÑÿ™ŸÉŸÑŸÅÿ© ŸÑŸÑÿ¢ÿÆÿ±ŸäŸÜ.' },
            
            feature5Title: { en: 'Bilingual Platform', ar: 'ŸÖŸÜÿµÿ© ÿ´ŸÜÿßÿ¶Ÿäÿ© ÿßŸÑŸÑÿ∫ÿ©' },
            feature5Text: { en: 'Full support for Arabic and English to serve all businesses in the UAE market.', ar: 'ÿØÿπŸÖ ŸÉÿßŸÖŸÑ ŸÑŸÑÿ∫ÿ© ÿßŸÑÿπÿ±ÿ®Ÿäÿ© ŸàÿßŸÑÿ•ŸÜÿ¨ŸÑŸäÿ≤Ÿäÿ© ŸÑÿÆÿØŸÖÿ© ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿπŸÖÿßŸÑ ŸÅŸä ÿßŸÑÿ≥ŸàŸÇ ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™Ÿä.' },
            
            feature6Title: { en: 'Mobile Optimized', ar: 'ŸÖÿ≠ÿ≥ŸëŸÜ ŸÑŸÑÿ¨ŸàÿßŸÑ' },
            feature6Text: { en: 'Access your projects and manage your business from anywhere with our mobile-optimized platform.', ar: 'ÿßŸÑŸàÿµŸàŸÑ ÿ•ŸÑŸâ ŸÖÿ¥ÿßÿ±ŸäÿπŸÉ Ÿàÿ•ÿØÿßÿ±ÿ© ÿπŸÖŸÑŸÉ ŸÖŸÜ ÿ£Ÿä ŸÖŸÉÿßŸÜ ŸÖÿπ ŸÖŸÜÿµÿ™ŸÜÿß ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜÿ© ŸÑŸÑÿ¨ŸàÿßŸÑ.' },
            
            // Pricing Section
            pricingTitle: { en: 'Choose Your Plan', ar: 'ÿßÿÆÿ™ÿ± ÿÆÿ∑ÿ™ŸÉ' },
            pricingSubtitle: { en: 'Flexible pricing options designed for businesses of all sizes in the UAE construction market.', ar: 'ÿÆŸäÿßÿ±ÿßÿ™ ÿ™ÿ≥ÿπŸäÿ± ŸÖÿ±ŸÜÿ© ŸÖÿµŸÖŸÖÿ© ŸÑŸÑÿ£ÿπŸÖÿßŸÑ ŸÖŸÜ ÿ¨ŸÖŸäÿπ ÿßŸÑÿ£ÿ≠ÿ¨ÿßŸÖ ŸÅŸä ÿ≥ŸàŸÇ ÿßŸÑÿ®ŸÜÿßÿ° ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™Ÿä.' },
            
            plan1Title: { en: 'Verified Companies', ar: 'ÿßŸÑÿ¥ÿ±ŸÉÿßÿ™ ÿßŸÑŸÖŸàÿ´ŸÇÿ©' },
            plan1Price: { en: 'FREE', ar: 'ŸÖÿ¨ÿßŸÜŸä' },
            plan1Period: { en: 'Always Free', ar: 'ŸÖÿ¨ÿßŸÜŸä ÿØÿßÿ¶ŸÖÿßŸã' },
            plan1Feature1: { en: '‚úì Post unlimited projects', ar: '‚úì ŸÜÿ¥ÿ± ŸÖÿ¥ÿßÿ±Ÿäÿπ ÿ∫Ÿäÿ± ŸÖÿ≠ÿØŸàÿØÿ©' },
            plan1Feature2: { en: '‚úì Access all contracts', ar: '‚úì ÿßŸÑŸàÿµŸàŸÑ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿπŸÇŸàÿØ' },
            plan1Feature3: { en: '‚úì Company profile & verification badge', ar: '‚úì ŸÖŸÑŸÅ ÿßŸÑÿ¥ÿ±ŸÉÿ© Ÿàÿ¥ÿßÿ±ÿ© ÿßŸÑÿ™Ÿàÿ´ŸäŸÇ' },
            plan1Feature4: { en: '‚úì Basic project management tools', ar: '‚úì ÿ£ÿØŸàÿßÿ™ ÿ•ÿØÿßÿ±ÿ© ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©' },
            plan1Feature5: { en: '‚úì Direct messaging', ar: '‚úì ÿßŸÑÿ±ÿ≥ÿßÿ¶ŸÑ ÿßŸÑŸÖÿ®ÿßÿ¥ÿ±ÿ©' },
            plan1Btn: { en: 'Get Verified', ar: 'ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿßŸÑÿ™Ÿàÿ´ŸäŸÇ' },
            
            plan2Title: { en: 'Premium Plan', ar: 'ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑŸÖŸÖŸäÿ≤ÿ©' },
            plan2Period: { en: 'AED / month', ar: 'ÿØÿ±ŸáŸÖ / ÿ¥Ÿáÿ±' },
            plan2Feature1: { en: '‚úì Everything in Free Plan', ar: '‚úì ŸÉŸÑ ÿ¥Ÿäÿ° ŸÅŸä ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑŸÖÿ¨ÿßŸÜŸäÿ©' },
            plan2Feature2: { en: '‚úì Featured project listings', ar: '‚úì ŸÇŸàÿßÿ¶ŸÖ ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ ÿßŸÑŸÖŸÖŸäÿ≤ÿ©' },
            plan2Feature3: { en: '‚úì Advanced analytics & reporting', ar: '‚úì ÿßŸÑÿ™ÿ≠ŸÑŸäŸÑÿßÿ™ ŸàÿßŸÑÿ™ŸÇÿßÿ±Ÿäÿ± ÿßŸÑŸÖÿ™ŸÇÿØŸÖÿ©' },
            plan2Feature4: { en: '‚úì Priority customer support', ar: '‚úì ÿØÿπŸÖ ÿßŸÑÿπŸÖŸÑÿßÿ° ÿ∞Ÿà ÿßŸÑÿ£ŸàŸÑŸàŸäÿ©' },
            plan2Feature5: { en: '‚úì Enhanced company profile', ar: '‚úì ŸÖŸÑŸÅ ÿßŸÑÿ¥ÿ±ŸÉÿ© ÿßŸÑŸÖÿ≠ÿ≥ŸëŸÜ' },
            plan2Feature6: { en: '‚úì Unlimited file uploads', ar: '‚úì ÿ™ÿ≠ŸÖŸäŸÑ ŸÖŸÑŸÅÿßÿ™ ÿ∫Ÿäÿ± ŸÖÿ≠ÿØŸàÿØ' },
            plan2Btn: { en: 'Start Premium', ar: 'ÿßÿ®ÿØÿ£ ÿßŸÑŸÖŸÖŸäÿ≤ÿ©' },
            
            plan3Title: { en: 'Basic Plan', ar: 'ÿßŸÑÿÆÿ∑ÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©' },
            plan3Period: { en: 'AED / month', ar: 'ÿØÿ±ŸáŸÖ / ÿ¥Ÿáÿ±' },
            plan3Feature1: { en: '‚úì Post up to 10 projects/month', ar: '‚úì ŸÜÿ¥ÿ± ÿ≠ÿ™Ÿâ 10 ŸÖÿ¥ÿßÿ±Ÿäÿπ/ÿ¥Ÿáÿ±' },
            plan3Feature2: { en: '‚úì Access to all contracts', ar: '‚úì ÿßŸÑŸàÿµŸàŸÑ ŸÑÿ¨ŸÖŸäÿπ ÿßŸÑÿπŸÇŸàÿØ' },
            plan3Feature3: { en: '‚úì Basic company profile', ar: '‚úì ŸÖŸÑŸÅ ÿßŸÑÿ¥ÿ±ŸÉÿ© ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿä' },
            plan3Feature4: { en: '‚úì Standard project tools', ar: '‚úì ÿ£ÿØŸàÿßÿ™ ÿßŸÑŸÖÿ¥ÿßÿ±Ÿäÿπ ÿßŸÑŸÖÿπŸäÿßÿ±Ÿäÿ©' },
            plan3Feature5: { en: '‚úì Email support', ar: '‚úì ÿØÿπŸÖ ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä' },
            plan3Btn: { en: 'Start Basic', ar: 'ÿßÿ®ÿØÿ£ ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿ©' },
            
            popularBadge: { en: 'Most Popular', ar: 'ÿßŸÑÿ£ŸÉÿ´ÿ± ÿ¥ÿπÿ®Ÿäÿ©' },
            
            // Footer
            footerText: { en: '¬© 2025 Helmet360. All rights reserved. Made for the UAE construction industry.', ar: '¬© 2025 ÿÆŸàÿ∞ÿ©360. ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©. ŸÖÿµŸÜŸàÿπ ŸÑÿµŸÜÿßÿπÿ© ÿßŸÑÿ®ŸÜÿßÿ° ŸÅŸä ÿØŸàŸÑÿ© ÿßŸÑÿ•ŸÖÿßÿ±ÿßÿ™.' },
            
            // Login Modal
            loginTitle: { en: 'Login to Your Account', ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ŸÑÿ≠ÿ≥ÿßÿ®ŸÉ' },
            loginEmailLabel: { en: 'Email', ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä' },
            loginPasswordLabel: { en: 'Password', ar: 'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±' },
            loginText: { en: 'Login', ar: 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ' },
            loginSignupText: { en: "Don't have an account?", ar: 'ŸÑŸäÿ≥ ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ®ÿü' },
            loginSignupLink: { en: 'Register here', ar: 'ÿ≥ÿ¨ŸÑ ŸáŸÜÿß' },
            
            // Register Modal
            registerTitle: { en: 'Create Your Account', ar: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®ŸÉ' },
            companyNameLabel: { en: 'Company Name', ar: 'ÿßÿ≥ŸÖ ÿßŸÑÿ¥ÿ±ŸÉÿ©' },
            businessTypeLabel: { en: 'Business Type', ar: 'ŸÜŸàÿπ ÿßŸÑÿπŸÖŸÑ' },
            businessTypeOption0: { en: 'Select business type', ar: 'ÿßÿÆÿ™ÿ± ŸÜŸàÿπ ÿßŸÑÿπŸÖŸÑ' },
            businessTypeOption1: { en: 'Construction Company', ar: 'ÿ¥ÿ±ŸÉÿ© ÿ®ŸÜÿßÿ°' },
            businessTypeOption2: { en: 'Contracting Company', ar: 'ÿ¥ÿ±ŸÉÿ© ŸÖŸÇÿßŸàŸÑÿßÿ™' },
            businessTypeOption3: { en: 'Materials Supplier', ar: 'ŸÖŸàÿ±ÿØ ŸÖŸàÿßÿØ' },
            contactPersonLabel: { en: 'Contact Person', ar: 'ÿßŸÑÿ¥ÿÆÿµ ÿßŸÑŸÖÿ≥ÿ§ŸàŸÑ' },
            phoneLabel: { en: 'Phone', ar: 'ÿßŸÑŸáÿßÿ™ŸÅ' },
            emailLabel: { en: 'Email', ar: 'ÿßŸÑÿ®ÿ±ŸäÿØ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä' },
            passwordLabel: { en: 'Password', ar: 'ŸÉŸÑŸÖÿ© ÿßŸÑŸÖÿ±Ÿàÿ±' },
            cityLabel: { en: 'City', ar: 'ÿßŸÑŸÖÿØŸäŸÜÿ©' },
            registerText: { en: 'Create Account', ar: 'ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®' },
            registerLoginText: { en: 'Already have an account?', ar: 'ŸÑÿØŸäŸÉ ÿ≠ÿ≥ÿßÿ® ÿ®ÿßŸÑŸÅÿπŸÑÿü' },
            registerLoginLink: { en: 'Login here', ar: 'ÿ≥ÿ¨ŸÑ ÿØÿÆŸàŸÑ ŸáŸÜÿß' },
            
            // Dashboard Modal
            dashboardTitle: { en: 'Company Dashboard', ar: 'ŸÑŸàÿ≠ÿ© ÿ™ÿ≠ŸÉŸÖ ÿßŸÑÿ¥ÿ±ŸÉÿ©' },
            dashboardLoading: { en: 'Loading dashboard...', ar: 'ÿ™ÿ≠ŸÖŸäŸÑ ŸÑŸàÿ≠ÿ© ÿßŸÑÿ™ÿ≠ŸÉŸÖ...' }
        };

        // Safe element update function
        function updateElement(id, text) {
            try {
                const element = document.getElementById(id);
                if (element) {
                    element.textContent = text;
                }
            } catch (error) {
                console.error(`Error updating element ${id}:`, error);
            }
        }

        // Update all text based on language
        function updateAllText() {
            const lang = isArabic ? 'ar' : 'en';
            
            // Update all elements with translations
            Object.keys(translations).forEach(key => {
                if (translations[key][lang]) {
                    updateElement(key, translations[key][lang]);
                }
            });
        }

        // Language toggle function
        function toggleLanguage() {
            isArabic = !isArabic;
            const html = document.documentElement;
            const langBtn = document.getElementById('langToggle');
            
            if (isArabic) {
                html.setAttribute('dir', 'rtl');
                html.setAttribute('lang', 'ar');
                if (langBtn) langBtn.textContent = 'English';
            } else {
                html.setAttribute('dir', 'ltr');
                html.setAttribute('lang', 'en');
                if (langBtn) langBtn.textContent = 'ÿπÿ±ÿ®Ÿä';
            }
            
            // Update all text
            setTimeout(updateAllText, 50);
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            try {
                checkUserSession();
                loadStats();
            } catch (error) {
                console.error('Initialization error:', error);
            }
        });

        // Check user session with fallback
        async function checkUserSession() {
            if (!supabase || isOfflineMode) {
                console.log('Running in offline mode - session check skipped');
                return;
            }
            
            try {
                const { data: { session } } = await supabase.auth.getSession();
                if (session) {
                    currentUser = session.user;
                    updateUIForLoggedInUser();
                }
            } catch (error) {
                console.warn('Session check failed, switching to offline mode:', error);
                isOfflineMode = true;
            }
        }

        // Update UI for logged in user
        function updateUIForLoggedInUser() {
            try {
                const loginBtn = document.getElementById('loginBtn');
                const registerBtn = document.getElementById('registerBtn');
                const userMenu = document.getElementById('userMenu');
                
                if (loginBtn) loginBtn.classList.add('hidden');
                if (registerBtn) registerBtn.classList.add('hidden');
                if (userMenu) userMenu.classList.remove('hidden');
            } catch (error) {
                console.error('UI update error:', error);
            }
        }

        // Update UI for logged out user
        function updateUIForLoggedOutUser() {
            try {
                const loginBtn = document.getElementById('loginBtn');
                const registerBtn = document.getElementById('registerBtn');
                const userMenu = document.getElementById('userMenu');
                
                if (loginBtn) loginBtn.classList.remove('hidden');
                if (registerBtn) registerBtn.classList.remove('hidden');
                if (userMenu) userMenu.classList.add('hidden');
            } catch (error) {
                console.error('UI update error:', error);
            }
        }

        // Modal functions
        function showModal(modalId) {
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'block';
                }
            } catch (error) {
                console.error('Show modal error:', error);
            }
        }

        function closeModal(modalId) {
            try {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'none';
                }
            } catch (error) {
                console.error('Close modal error:', error);
            }
        }

        function showLogin() {
            showModal('loginModal');
        }

        function showRegister() {
            showModal('registerModal');
        }

        function showDashboard() {
            showModal('dashboardModal');
            loadDashboard();
        }

        // Close modal when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // Login form handler
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const email = document.getElementById('loginEmail').value;
                    const password = document.getElementById('loginPassword').value;
                    const spinner = document.getElementById('loginSpinner');
                    const loginText = document.getElementById('loginText');
                    const alertDiv = document.getElementById('loginAlert');

                    try {
                        if (spinner) spinner.classList.remove('hidden');
                        if (loginText) loginText.textContent = isArabic ? 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ...' : 'Logging in...';

                        if (!supabase || isOfflineMode) {
                            // Offline mode demo
                            setTimeout(() => {
                                currentUser = { 
                                    id: 'demo-user', 
                                    email: email,
                                    companyData: {
                                        company_name: 'Demo Company',
                                        business_type: 'construction',
                                        city: 'Abu Dhabi',
                                        is_verified: true,
                                        created_at: new Date().toISOString()
                                    }
                                };
                                updateUIForLoggedInUser();
                                closeModal('loginModal');
                                
                                if (alertDiv) {
                                    alertDiv.innerHTML = `<div class="alert alert-success">${isArabic ? 'ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠! (Ÿàÿ∂ÿπ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™Ÿàÿ∂Ÿäÿ≠Ÿä)' : 'Login successful! (Demo Mode)'}</div>`;
                                }
                            }, 1000);
                            return;
                        }

                        const { data, error } = await supabase.auth.signInWithPassword({
                            email: email,
                            password: password,
                        });

                        if (error) throw error;

                        currentUser = data.user;
                        updateUIForLoggedInUser();
                        closeModal('loginModal');
                        
                        if (alertDiv) {
                            alertDiv.innerHTML = `<div class="alert alert-success">${isArabic ? 'ÿ™ŸÖ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ®ŸÜÿ¨ÿßÿ≠!' : 'Login successful!'}</div>`;
                        }
                        
                    } catch (error) {
                        if (alertDiv) {
                            alertDiv.innerHTML = `<div class="alert alert-error">${isArabic ? 'ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ: ' : 'Login error: '}${error.message}</div>`;
                        }
                    } finally {
                        if (spinner) spinner.classList.add('hidden');
                        if (loginText) loginText.textContent = isArabic ? 'ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ' : 'Login';
                    }
                });
            }

            // Register form handler
            const registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    
                    const formData = {
                        email: document.getElementById('email').value,
                        password: document.getElementById('password').value,
                        companyName: document.getElementById('companyName').value,
                        businessType: document.getElementById('businessType').value,
                        contactPerson: document.getElementById('contactPerson').value,
                        phone: document.getElementById('phone').value,
                        city: document.getElementById('city').value,
                    };

                    const spinner = document.getElementById('registerSpinner');
                    const registerText = document.getElementById('registerText');
                    const alertDiv = document.getElementById('registerAlert');

                    try {
                        if (spinner) spinner.classList.remove('hidden');
                        if (registerText) registerText.textContent = isArabic ? 'ÿ¨ÿßÿ±Ÿä ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ≠ÿ≥ÿßÿ®...' : 'Creating account...';

                        if (!supabase || isOfflineMode) {
                            // Offline mode demo
                            setTimeout(() => {
                                if (alertDiv) {
                                    alertDiv.innerHTML = `<div class="alert alert-success">${isArabic ? 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿ®ŸÜÿ¨ÿßÿ≠! (Ÿàÿ∂ÿπ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™Ÿàÿ∂Ÿäÿ≠Ÿä)' : 'Account created successfully! (Demo Mode)'}</div>`;
                                }
                                this.reset();
                            }, 1500);
                            return;
                        }

                        const { data: authData, error: authError } = await supabase.auth.signUp({
                            email: formData.email,
                            password: formData.password,
                        });

                        if (authError) throw authError;

                        if (authData.user) {
                            const { error: profileError } = await supabase
                                .from('companies')
                                .insert([
                                    {
                                        id: authData.user.id,
                                        company_name: formData.companyName,
                                        business_type: formData.businessType,
                                        contact_person: formData.contactPerson,
                                        phone: formData.phone,
                                        email: formData.email,
                                        city: formData.city,
                                    }
                                ]);

                            if (profileError) throw profileError;

                            if (alertDiv) {
                                alertDiv.innerHTML = `<div class="alert alert-success">${isArabic ? 'ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ° ÿßŸÑÿ≠ÿ≥ÿßÿ® ÿ®ŸÜÿ¨ÿßÿ≠! ÿ™ÿ≠ŸÇŸÇ ŸÖŸÜ ÿ®ÿ±ŸäÿØŸÉ ÿßŸÑÿ•ŸÑŸÉÿ™ÿ±ŸàŸÜŸä.' : 'Account created successfully! Check your email for verification.'}</div>`;
                            }
                            this.reset();
                        }
                        
                    } catch (error) {
                        if (alertDiv) {
                            alertDiv.innerHTML = `<div class="alert alert-error">${isArabic ? 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ: ' : 'Registration error: '}${error.message}</div>`;
                        }
                    } finally {
                        if (spinner) spinner.classList.add('hidden');
                        if (registerText) registerText.textContent = isArabic ? 'ÿ•ŸÜÿ¥ÿßÿ° ÿ≠ÿ≥ÿßÿ®' : 'Create Account';
                    }
                });
            }
        });

        // Logout function
        async function logout() {
            if (!supabase) return;
            
            try {
                await supabase.auth.signOut();
                currentUser = null;
                updateUIForLoggedOutUser();
            } catch (error) {
                console.error('Logout error:', error);
            }
        }

        // Load statistics with fallback
        async function loadStats() {
            if (!supabase || isOfflineMode) {
                // Demo statistics for offline mode
                updateElement('totalCompanies', '150+');
                updateElement('verifiedCompanies', '89');
                updateElement('activeProjects', '234');
                updateElement('contractValue', '45M+');
                updateElement('completedProjects', '456');
                return;
            }
            
            try {
                const { data, error } = await supabase
                    .from('platform_stats')
                    .select('*')
                    .eq('id', 1)
                    .single();

                if (data) {
                    updateElement('totalCompanies', data.total_companies + '+');
                    updateElement('verifiedCompanies', data.verified_companies.toString());
                    updateElement('activeProjects', data.active_projects.toString());
                    updateElement('contractValue', formatMoney(data.total_contract_value));
                    updateElement('completedProjects', data.completed_projects.toString());
                } else {
                    // Fallback to demo data
                    updateElement('totalCompanies', '150+');
                    updateElement('verifiedCompanies', '89');
                    updateElement('activeProjects', '234');
                    updateElement('contractValue', '45M+');
                    updateElement('completedProjects', '456');
                }
            } catch (error) {
                console.warn('Stats loading failed, using demo data:', error);
                isOfflineMode = true;
                updateElement('totalCompanies', '150+');
                updateElement('verifiedCompanies', '89');
                updateElement('activeProjects', '234');
                updateElement('contractValue', '45M+');
                updateElement('completedProjects', '456');
            }
        }

        // Format money
        function formatMoney(value) {
            if (value >= 1000000) {
                return (value / 1000000).toFixed(0) + 'M+';
            } else if (value >= 1000) {
                return (value / 1000).toFixed(0) + 'K+';
            }
            return value.toString();
        }

        // Load dashboard with fallback
        async function loadDashboard() {
            const content = document.getElementById('dashboardContent');
            
            if (!currentUser) {
                if (content) {
                    content.innerHTML = `<div class="alert alert-error">${isArabic ? 'Ÿäÿ±ÿ¨Ÿâ ÿ™ÿ≥ÿ¨ŸäŸÑ ÿßŸÑÿØÿÆŸàŸÑ ÿ£ŸàŸÑÿßŸã' : 'Please login first'}</div>`;
                }
                return;
            }

            if (!supabase || isOfflineMode) {
                // Demo dashboard for offline mode
                const companyData = currentUser.companyData || {
                    company_name: 'Demo Construction Company',
                    business_type: 'construction',
                    city: 'Abu Dhabi',
                    is_verified: true,
                    created_at: new Date().toISOString()
                };

                const verifiedBadge = companyData.is_verified 
                    ? '<span class="badge badge-verified">‚úì Verified</span>' 
                    : '<span class="badge badge-unverified">‚ö† Unverified</span>';

                if (content) {
                    content.innerHTML = `
                        <div style="text-align: left;">
                            <h3>${companyData.company_name} ${verifiedBadge}</h3>
                            <p><strong>${isArabic ? 'ŸÜŸàÿπ ÿßŸÑÿπŸÖŸÑ:' : 'Business Type:'}</strong> ${companyData.business_type}</p>
                            <p><strong>${isArabic ? 'ÿßŸÑŸÖÿØŸäŸÜÿ©:' : 'City:'}</strong> ${companyData.city}</p>
                            <p><strong>${isArabic ? 'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ:' : 'Member Since:'}</strong> ${new Date(companyData.created_at).toLocaleDateString()}</p>
                            
                            <hr style="margin: 20px 0;">
                            
                            <div class="alert alert-success">${isArabic ? 'Ÿàÿ∂ÿπ ÿßŸÑÿπÿ±ÿ∂ ÿßŸÑÿ™Ÿàÿ∂Ÿäÿ≠Ÿä - ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ©' : 'Demo Mode - Sample Data'}</div>
                            
                            <h4>${isArabic ? 'ŸÖÿ¥ÿßÿ±ŸäÿπŸÉ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©:' : 'Your Recent Projects:'}</h4>
                            <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <strong>${isArabic ? 'ŸÖÿ¥ÿ±Ÿàÿπ ÿ≥ŸÉŸÜŸä ŸÅŸä ÿ£ÿ®Ÿàÿ∏ÿ®Ÿä' : 'Residential Project in Abu Dhabi'}</strong>
                                <p>${isArabic ? 'ŸÖÿ¥ÿ±Ÿàÿπ ÿ®ŸÜÿßÿ° ŸÖÿ¨ŸÖÿπ ÿ≥ŸÉŸÜŸä ÿ≠ÿØŸäÿ´ ŸÅŸä ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿÆÿßŸÑÿØŸäÿ©...' : 'Modern residential complex construction project in Khalidiya area...'}</p>
                                <small>${isArabic ? 'ÿ£ŸÜÿ¥ÿ¶ ŸÅŸä:' : 'Created:'} ${new Date().toLocaleDateString()}</small>
                            </div>
                            <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                <strong>${isArabic ? 'ŸÖÿ¥ÿ±Ÿàÿπ ÿ™ÿ¨ÿßÿ±Ÿä ŸÅŸä ÿØÿ®Ÿä' : 'Commercial Project in Dubai'}</strong>
                                <p>${isArabic ? 'ÿ®ŸÜÿßÿ° ŸÖÿ±ŸÉÿ≤ ÿ™ÿ¨ÿßÿ±Ÿä ŸÖÿ™ÿπÿØÿØ ÿßŸÑÿßÿ≥ÿ™ÿÆÿØÿßŸÖÿßÿ™ ŸÅŸä ŸÖŸÜÿ∑ŸÇÿ© ÿßŸÑÿ£ÿπŸÖÿßŸÑ...' : 'Multi-use commercial center construction in business district...'}</p>
                                <small>${isArabic ? 'ÿ£ŸÜÿ¥ÿ¶ ŸÅŸä:' : 'Created:'} ${new Date(Date.now() - 86400000).toLocaleDateString()}</small>
                            </div>
                            
                            <div style="margin-top: 20px;">
                                <button class="btn btn-primary" onclick="alert('${isArabic ? 'ŸÇÿ±Ÿäÿ®ÿßŸã - ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ¥ÿ±Ÿàÿπ ÿ¨ÿØŸäÿØ' : 'Coming soon - Add new project'}')">${isArabic ? 'ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ¥ÿ±Ÿàÿπ ÿ¨ÿØŸäÿØ' : 'Add New Project'}</button>
                            </div>
                        </div>
                    `;
                }
                return;
            }

            try {
                const { data: companyData, error: companyError } = await supabase
                    .from('companies')
                    .select('*')
                    .eq('id', currentUser.id)
                    .single();

                if (companyError) throw companyError;

                const { data: projects, error: projectsError } = await supabase
                    .from('projects')
                    .select('*')
                    .eq('company_id', currentUser.id)
                    .order('created_at', { ascending: false })
                    .limit(5);

                if (projectsError) throw projectsError;

                const verifiedBadge = companyData.is_verified 
                    ? '<span class="badge badge-verified">‚úì Verified</span>' 
                    : '<span class="badge badge-unverified">‚ö† Unverified</span>';

                if (content) {
                    content.innerHTML = `
                        <div style="text-align: left;">
                            <h3>${companyData.company_name} ${verifiedBadge}</h3>
                            <p><strong>${isArabic ? 'ŸÜŸàÿπ ÿßŸÑÿπŸÖŸÑ:' : 'Business Type:'}</strong> ${companyData.business_type}</p>
                            <p><strong>${isArabic ? 'ÿßŸÑŸÖÿØŸäŸÜÿ©:' : 'City:'}</strong> ${companyData.city}</p>
                            <p><strong>${isArabic ? 'ÿ™ÿßÿ±ŸäÿÆ ÿßŸÑÿ™ÿ≥ÿ¨ŸäŸÑ:' : 'Member Since:'}</strong> ${new Date(companyData.created_at).toLocaleDateString()}</p>
                            
                            <hr style="margin: 20px 0;">
                            
                            <h4>${isArabic ? 'ŸÖÿ¥ÿßÿ±ŸäÿπŸÉ ÿßŸÑÿ£ÿÆŸäÿ±ÿ©:' : 'Your Recent Projects:'}</h4>
                            ${projects && projects.length > 0 ? 
                                projects.map(project => `
                                    <div style="background: #f8fafc; padding: 15px; border-radius: 8px; margin-bottom: 10px;">
                                        <strong>${project.title}</strong>
                                        <p>${project.description ? project.description.substring(0, 100) + '...' : (isArabic ? 'ŸÑÿß ŸäŸàÿ¨ÿØ ŸàÿµŸÅ' : 'No description')}</p>
                                        <small>${isArabic ? 'ÿ£ŸÜÿ¥ÿ¶ ŸÅŸä:' : 'Created:'} ${new Date(project.created_at).toLocaleDateString()}</small>
                                    </div>
                                `).join('') :
                                `<p>${isArabic ? 'ŸÑÿß ÿ™Ÿàÿ¨ÿØ ŸÖÿ¥ÿßÿ±Ÿäÿπ ÿ≠ÿ™Ÿâ ÿßŸÑÿ¢ŸÜ' : 'No projects yet'}</p>`
                            }
                            
                            <div style="margin-top: 20px;">
                                <button class="btn btn-primary" onclick="alert('${isArabic ? 'ŸÇÿ±Ÿäÿ®ÿßŸã - ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ¥ÿ±Ÿàÿπ ÿ¨ÿØŸäÿØ' : 'Coming soon - Add new project'}')">${isArabic ? 'ÿ•ÿ∂ÿßŸÅÿ© ŸÖÿ¥ÿ±Ÿàÿπ ÿ¨ÿØŸäÿØ' : 'Add New Project'}</button>
                            </div>
                        </div>
                    `;
                }
                
            } catch (error) {
                if (content) {
                    content.innerHTML = `<div class="alert alert-error">${isArabic ? 'ÿÆÿ∑ÿ£ ŸÅŸä ÿ™ÿ≠ŸÖŸäŸÑ ÿßŸÑÿ®ŸäÿßŸÜÿßÿ™' : 'Error loading dashboard data'}</div>`;
                }
                console.error('Dashboard loading error:', error);
                isOfflineMode = true;
            }
        }
    </script>
</body>
</html>
